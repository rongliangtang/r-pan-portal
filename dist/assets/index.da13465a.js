/* empty css                  */import{v as Ge}from"./el-loading.f6a568b8.js";import{E as Ye}from"./el-tree.82f25188.js";import{E as Qe,a as Xe}from"./el-tag.dc06c527.js";import{E as ea,b as aa,d as oa}from"./el-input.14235b07.js";import"./el-tooltip.6937a96a.js";import{E as sa}from"./el-scrollbar.f97ee502.js";import{E as ta,a as la}from"./el-breadcrumb-item.4e15d529.js";import{E as na}from"./el-divider.a2086d29.js";import{E as ra}from"./el-link.a2a85b3f.js";import{b as da,q as ia,d as ve,u as ca,o as f,g as m,n as P,a as x,j as X,h as g,C as l,D as ua,_ as fa,k as c,t as v,p as pa,Y as ma,r,aA as M,Z as ha,cx as va,$ as ee,F as _a,W as ga,aE as ya,S as wa,M as o,w as s,aC as R,aG as Ca,aF as ba,aD as p,ck as ka,am as Sa,bZ as Ea,al as he,aB as ae,V as _,cv as Fa,cy as Ta,cz as Da,cj as Ia,f as Va}from"./index.3bce1910.js";import{s as k}from"./index.f644bb06.js";import"./index.69e8acc8.js";import"./debounce.95cada16.js";const xa=da({header:{type:String,default:""},footer:{type:String,default:""},bodyStyle:{type:ia([String,Object,Array]),default:""},bodyClass:String,shadow:{type:String,values:["always","hover","never"],default:"always"}}),Ra=ve({name:"ElCard"}),Pa=ve({...Ra,props:xa,setup(_e){const y=ca("card");return(d,j)=>(f(),m("div",{class:P([x(y).b(),x(y).is(`${d.shadow}-shadow`)])},[d.$slots.header||d.header?(f(),m("div",{key:0,class:P(x(y).e("header"))},[X(d.$slots,"header",{},()=>[c(v(d.header),1)])],2)):g("v-if",!0),l("div",{class:P([x(y).e("body"),d.bodyClass]),style:ua(d.bodyStyle)},[X(d.$slots,"default")],6),d.$slots.footer||d.footer?(f(),m("div",{key:1,class:P(x(y).e("footer"))},[X(d.$slots,"footer",{},()=>[c(v(d.footer),1)])],2)):g("v-if",!0)],2))}});var Ua=fa(Pa,[["__file","card.vue"]]);const $a=pa(Ua);const Oa={"element-loading-text":"\u52A0\u8F7D\u4E2D...",class:"pan-share-content"},Ba={class:"pan-share-header-content"},Na={class:"pan-share-header-content-wrapper"},za={key:0,class:"pan-share-header-user-info-content"},La={key:1,class:"pan-share-header-button-content"},Aa={class:"pan-share-list-content"},Ma={class:"pan-share-list-wrapper"},ja={key:0,slot:"header",class:"pan-share-list-card-header"},Ha={class:"pan-share-list-card-header-share-info-content"},Ka={class:"pan-share-list-card-header-share-info"},Wa={class:"pan-share-list-card-header-time"},Ja={class:"pan-share-list-card-header-create-date"},qa=l("i",{class:"fa fa-clock-o"},null,-1),Za={class:"pan-share-list-card-header-expire-date"},Ga=l("i",{class:"fa fa-clock-o"},null,-1),Ya={class:"pan-share-list-card-button-group"},Qa={key:1,class:"pan-share-list-card-error-message"},Xa=l("span",null,"Sorry,\u60A8\u6765\u665A\u5566~ \u8BE5\u5206\u4EAB\u5DF2\u5230\u671F\u6216\u5DF2\u5931\u6548~",-1),eo=[Xa],ao={key:2,class:"pan-share-list-card-operate-content"},oo={class:"pan-share-list-card-operate-bread-crumb"},so=["onClick"],to={key:3,class:"pan-share-list"},lo=["onClick"],no={style:{cursor:"pointer"}},ro={class:"file-operation-content"},io={class:"dialog-footer"},co={class:"pan-share-code-content"},uo={class:"pan-share-code-wrapper"},fo={class:"tree-content"},po={class:"custom-tree-node"},mo={class:"dialog-footer"},Ro={__name:"index",setup(_e){const y=ma(),d=r(null),j=r(null),H=r(null),ge=r(null),oe=r(null),se=r(null),ye=()=>{oe.value.focus()},we=()=>{d.value.resetFields()},Ce=()=>{se.value.focus()},be=()=>{H.value.resetFields()},ke=M({username:[{validator:(e,a,t)=>{if(!_.checkUsername(a)){t("\u8BF7\u8F93\u51656-16\u4F4D\u53EA\u5305\u542B\u6570\u5B57\u548C\u5B57\u6BCD\u7684\u7528\u6237\u540D");return}t()},trigger:"blur"}],password:[{validator:(e,a,t)=>{if(!_.checkPassword(a)){t("\u8BF7\u8F93\u51658-16\u4F4D\u7684\u5BC6\u7801");return}t()},trigger:"blur"}]}),Se=M({shareCode:[{required:!0,message:"\u8BF7\u8F93\u5165\u63D0\u53D6\u7801",trigger:"blur"}]}),w=M({username:"",password:""}),u=r(!1),U=r(""),S=r(!1),E=r(!1),F=r(!1),$=M({shareCode:""}),O=r(""),T=r(!1),K=r([]),Ee=r(window.innerHeight-300),h=r([]),te=r(!0),le=r(""),W=r(""),D=r([{id:"-1",name:"\u5168\u90E8\u6587\u4EF6"}]),J=r([]),b=r(!1),B=r(void 0),Fe=e=>{let a=e.shareUserInfoVO.username,t=e.shareName;O.value=a+"\u7684\u5206\u4EAB\uFF1A"+t,le.value=e.createTime,e.shareDay===0?W.value="\u6C38\u4E45\u6709\u6548":W.value=e.shareEndTime,K.value=e.rpanUserFileVOList},q=()=>y.params.shareId,ne=()=>{T.value=!0},Te=()=>{k.getSimpleShareDetail({shareId:q()},e=>{e.code===0?(F.value=!0,O.value=e.data.shareUserInfoVO.username+"\u7684\u5206\u4EAB\uFF1A"+e.data.shareName):(F.value=!1,ne())})},Z=()=>{k.getShareDetail(e=>{e.code===0?Fe(e.data):e.code===4?Te():ne()})},N=()=>{R.infoWithoutPageJump(e=>{e.code===0?(U.value=e.data.username,E.value=!0):(U.value="",E.value=!1)})},z=()=>{S.value=!0},De=()=>{Ca.confirm("\u786E\u5B9A\u8981\u9000\u51FA\u767B\u5F55\u5417?","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>{R.exit(()=>{ba(),E.value=!1,U.value=""},e=>{p.error(e.message)})})},G=async()=>{await d.value.validate((e,a)=>{e&&(u.value=!0,R.login({username:w.username,password:w.password},t=>{u.value=!1,Fa(t.data),S.value=!1,N()},t=>{u.value=!1,p.error(t.message)}))})},Ie=()=>{window.location.href="/"},re=async()=>{await H.value.validate(e=>{e&&(u.value=!0,k.checkShareCode({shareId:q(),shareCode:$.shareCode},a=>{a.code===0?(u.value=!1,Ta(a.data),F.value=!1,Z()):(u.value=!1,p.error(a.message))}))})},Ve=e=>{h.value=e},xe=(e,a,t,C)=>{_.showOperation(t)},Re=(e,a,t,C)=>{_.hiddenOperation(t)},Pe=e=>{e.folderFlag===1&&Ue(e)},Ue=e=>{D.value.push({id:e.fileId,name:e.filename}),de(e.fileId)},de=e=>{k.getShareFiles({parentId:e},a=>{a.code===0?K.value=a.data:window.location.reload()})},$e=e=>{if(e==="-1")D.value=[{id:"-1",name:"\u5168\u90E8\u6587\u4EF6"}],Z();else{let a=new Array;D.value.some(t=>{if(a.push(t),t.id===e)return!0}),D.value=a,de(e)}},Oe=()=>{if(!h.value||h.value.length===0){p.error("\u8BF7\u9009\u62E9\u8981\u4E0B\u8F7D\u7684\u6587\u4EF6");return}for(let e=0,a=h.value.length;e<a;e++)if(h.value[e].folderFlag===1){p.error("\u6587\u4EF6\u5939\u6682\u4E0D\u652F\u6301\u4E0B\u8F7D");return}ie(h.value)},ie=(e,a)=>{a||(a=0),e.length!==a&&setTimeout(function(){ce(e[a]),a++,ie(e,a)},500)},ce=e=>{if(e.folderFlag===1){p.error("\u6587\u4EF6\u5939\u6682\u4E0D\u652F\u6301\u4E0B\u8F7D");return}R.infoWithoutPageJump(a=>{a.code===0?k.getSimpleShareDetail({shareId:q()},t=>{if(t.code===0){let C=_.getUrlPrefix()+"/share/file/download?fileId="+_.handleId(e.fileId)+"&shareToken="+Da()+"&authorization="+Ia(),I=e.filename,i=document.createElement("a");i.style.display="none",i.href=C,i.setAttribute("download",I),document.body.appendChild(i),i.click(),document.body.removeChild(i)}else window.location.reload()}):(N(),z())})},Be=()=>{J.value=new Array,B.value=void 0},Ne=()=>{ka.getFolderTree(e=>{J.value=e.data},e=>{p.error(e.message)})},ze=()=>{u.value=!0;let e=j.value.getCurrentNode();if(!e){p.error("\u8BF7\u9009\u62E9\u6587\u4EF6\u5939"),u.value=!1;return}Le(e.id)},ue=e=>{if(e)B.value=e;else if(!h.value||h.value.length===0){p.error("\u8BF7\u9009\u62E9\u8981\u4FDD\u5B58\u7684\u6587\u4EF6");return}R.infoWithoutPageJump(a=>{a.code===0?b.value=!0:z()})},Le=e=>{let a="";if(B.value)a=B.value.fileId;else{let t=new Array;h.value.forEach(C=>{t.push(C.fileId)}),a=t.join(_.COMMON_SEPARATOR)}k.saveShareFiles({fileIds:a,targetParentId:e},t=>{t.code===0?(p.success("\u4FDD\u5B58\u6210\u529F"),b.value=!1):t.code===10?(b.value=!1,N(),z()):p.error(t.message),u.value=!1})},Ae=e=>_.getFileFontElement(e);return ha(()=>{va(),Z(),N(),te.value=!1}),(e,a)=>{const t=ra,C=ee("DocumentCopy"),I=_a,i=ga,Me=ee("Download"),je=na,He=ta,Ke=la,L=Qe,fe=sa,We=Xe,pe=$a,Y=ya,A=ea,me=aa,Q=oa,Je=ee("Folder"),qe=Ye,Ze=Ge;return wa((f(),m("div",Oa,[l("div",Ba,[l("div",Na,[l("div",{class:"pan-share-header-title-font-content"},[l("span",{class:"pan-share-header-title-font",onClick:Ie},"R Pan")]),E.value?(f(),m("div",za,[o(t,{underline:!1,type:"success",class:"pan-share-username"},{default:s(()=>[c(" \u6B22\u8FCE\u60A8,"+v(U.value),1)]),_:1}),o(t,{underline:!1,type:"success",class:"pan-share-exit-button",onClick:De},{default:s(()=>[c(" \u9000\u51FA ")]),_:1})])):g("",!0),E.value?g("",!0):(f(),m("div",La,[o(t,{underline:!1,type:"primary",class:"pan-share-login-button",onClick:z},{default:s(()=>[c(" \u767B\u5F55 ")]),_:1}),o(t,{underline:!1,type:"primary",class:"pan-share-register-button",href:"/register",target:"_blank"},{default:s(()=>[c(" \u6CE8\u518C ")]),_:1})]))])]),l("div",Aa,[l("div",Ma,[o(pe,{shadow:"always",class:"pan-share-list-card"},{default:s(()=>[T.value?g("",!0):(f(),m("div",ja,[l("div",Ha,[l("span",Ka,v(O.value),1),l("div",Wa,[l("span",Ja,[qa,c("\u5206\u4EAB\u65F6\u95F4\uFF1A"+v(le.value),1)]),l("span",Za,[Ga,c("\u5931\u6548\u65F6\u95F4\uFF1A"+v(W.value),1)])])]),l("div",Ya,[o(i,{type:"success",size:"default",round:"",onClick:a[0]||(a[0]=n=>ue(void 0))},{default:s(()=>[c("\u4FDD\u5B58\u5230\u6211\u7684R\u76D8 "),o(I,{class:"el-icon--right"},{default:s(()=>[o(C)]),_:1})]),_:1}),o(i,{type:"info",size:"default",round:"",onClick:Oe},{default:s(()=>[c("\u4E0B\u8F7D "),o(I,{class:"el-icon--right"},{default:s(()=>[o(Me)]),_:1})]),_:1})]),o(je)])),T.value?(f(),m("div",Qa,eo)):g("",!0),T.value?g("",!0):(f(),m("div",ao,[l("div",oo,[o(Ke,{"separator-class":"el-icon-arrow-right"},{default:s(()=>[(f(!0),m(Sa,null,Ea(D.value,(n,V)=>(f(),Va(He,{key:V},{default:s(()=>[l("a",{class:"breadcrumb-item-a",onClick:_o=>$e(n.id),href:"#"},v(n.name),9,so)]),_:2},1024))),128))]),_:1})])])),T.value?g("",!0):(f(),m("div",to,[o(We,{ref_key:"fileTableRef",ref:ge,data:K.value,height:Ee.value,"tooltip-effect":"dark",style:{width:"100%"},onSelectionChange:Ve,onCellMouseEnter:xe,onCellMouseLeave:Re},{default:s(()=>[o(L,{type:"selection",width:"55"}),o(L,{label:"\u6587\u4EF6\u540D",prop:"filename",sortable:"","show-overflow-tooltip":"","min-width":"750"},{default:s(n=>[l("div",{onClick:V=>Pe(n.row),class:"file-name-content"},[l("i",{class:P(Ae(n.row.fileType)),style:{"margin-right":"15px","font-size":"20px",cursor:"pointer"}},null,2),l("span",no,v(n.row.filename),1)],8,lo),l("div",ro,[o(fe,{class:"item",effect:"light",content:"\u4FDD\u5B58\u5230\u6211\u7684R\u76D8",placement:"top"},{default:s(()=>[o(i,{type:"success",icon:"DocumentCopy",size:"small",circle:"",onClick:V=>ue(n.row)},null,8,["onClick"])]),_:2},1024),o(fe,{class:"item",effect:"light",content:"\u4E0B\u8F7D",placement:"top"},{default:s(()=>[o(i,{type:"info",icon:"Download",size:"small",circle:"",onClick:V=>ce(n.row)},null,8,["onClick"])]),_:2},1024)])]),_:1}),o(L,{prop:"fileSizeDesc",sortable:"",label:"\u5927\u5C0F","min-width":"120",align:"center"}),o(L,{prop:"updateTime",sortable:"",align:"center",label:"\u4FEE\u6539\u65E5\u671F","min-width":"240"})]),_:1},8,["data","height"])]))]),_:1})])]),o(Q,{title:"\u6B22\u8FCE\u767B\u5F55",modelValue:S.value,"onUpdate:modelValue":a[5]||(a[5]=n=>S.value=n),onOpened:ye,onClosed:we,width:"30%","append-to-body":"","modal-append-to-body":!1,center:""},{footer:s(()=>[l("span",io,[o(i,{onClick:a[4]||(a[4]=n=>S.value=!1)},{default:s(()=>[c("\u53D6 \u6D88")]),_:1}),o(i,{type:"primary",onClick:G,loading:u.value},{default:s(()=>[c("\u786E \u5B9A")]),_:1},8,["loading"])])]),default:s(()=>[l("div",null,[o(me,{"label-width":"100px",rules:ke,ref_key:"loginFormRef",ref:d,model:w,"status-icon":"",onSubmit:a[3]||(a[3]=he(()=>{},["prevent"]))},{default:s(()=>[o(A,{label:"\u7528\u6237\u540D",prop:"username"},{default:s(()=>[o(Y,{type:"text",ref_key:"usernameEl",ref:oe,onKeyup:ae(G,["enter","native"]),modelValue:w.username,"onUpdate:modelValue":a[1]||(a[1]=n=>w.username=n),autocomplete:"off"},null,8,["modelValue"])]),_:1}),o(A,{label:"\u5BC6\u7801",prop:"password"},{default:s(()=>[o(Y,{type:"password","show-password":"",onKeyup:ae(G,["enter","native"]),modelValue:w.password,"onUpdate:modelValue":a[2]||(a[2]=n=>w.password=n),autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","model"])])]),_:1},8,["modelValue"]),o(Q,{modelValue:F.value,"onUpdate:modelValue":a[8]||(a[8]=n=>F.value=n),onOpened:Ce,onClosed:be,width:"30%",fullscreen:"","append-to-body":"","modal-append-to-body":!1,"close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},{default:s(()=>[l("div",co,[l("div",uo,[o(pe,{header:O.value,shadow:"always",class:"pan-share-code-card"},{default:s(()=>[o(me,{class:"pan-share-code-form",inline:"",rules:Se,ref_key:"shareCodeFormRef",ref:H,model:$,onSubmit:a[7]||(a[7]=he(()=>{},["prevent"]))},{default:s(()=>[o(A,{label:"\u63D0\u53D6\u7801",prop:"shareCode"},{default:s(()=>[o(Y,{type:"text",ref_key:"shareCodeEl",ref:se,onKeyup:ae(re,["enter","native"]),modelValue:$.shareCode,"onUpdate:modelValue":a[6]||(a[6]=n=>$.shareCode=n),autocomplete:"off"},null,8,["modelValue"])]),_:1}),o(A,null,{default:s(()=>[o(i,{type:"primary",loading:u.value,onClick:re},{default:s(()=>[c("\u786E \u5B9A")]),_:1},8,["loading"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["header"])])])]),_:1},8,["modelValue"]),o(Q,{title:"\u4FDD\u5B58\u5230\u6211\u7684R\u76D8",modelValue:b.value,"onUpdate:modelValue":a[10]||(a[10]=n=>b.value=n),onOpen:Ne,onClosed:Be,width:"30%","append-to-body":"","modal-append-to-body":!1,center:""},{footer:s(()=>[l("span",mo,[o(i,{onClick:a[9]||(a[9]=n=>b.value=!1)},{default:s(()=>[c("\u53D6 \u6D88")]),_:1}),o(i,{type:"primary",onClick:ze,loading:u.value},{default:s(()=>[c("\u786E \u5B9A")]),_:1},8,["loading"])])]),default:s(()=>[l("div",fo,[o(qe,{data:J.value,class:"tree","empty-text":"\u6682\u65E0\u6587\u4EF6\u5939\u6570\u636E","default-expand-all":"","highlight-current":"","check-on-click-node":"","expand-on-click-node":!1,ref_key:"treeRef",ref:j},{default:s(({node:n,data:V})=>[l("span",po,[o(I,{size:20,style:{"margin-right":"15px",cursor:"pointer"}},{default:s(()=>[o(Je)]),_:1}),l("span",null,v(n.label),1)])]),_:1},8,["data"])])]),_:1},8,["modelValue"])])),[[Ze,te.value]])}}};export{Ro as default};
